<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rennesong.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="生成树算法 介绍下，计算机科学中的经典算法。理论部分 交换机中生成树算法工作原理 概括来讲，STP的工作流程可以分为三个阶段： * Root Brideg 选举 * Root Port (for non-root bridge) 选举 * Designated Port 选举 - 【http:&#x2F;&#x2F;www.omnisecu.com&#x2F;cisco-certified-network-associate-">
<meta property="og:type" content="article">
<meta property="og:title" content="Ethernet 交换实验准备工作">
<meta property="og:url" content="http://rennesong.com/2016/10/22/TP-Ethernet-md/index.html">
<meta property="og:site_name" content="Rennesong&#39;s blog">
<meta property="og:description" content="生成树算法 介绍下，计算机科学中的经典算法。理论部分 交换机中生成树算法工作原理 概括来讲，STP的工作流程可以分为三个阶段： * Root Brideg 选举 * Root Port (for non-root bridge) 选举 * Designated Port 选举 - 【http:&#x2F;&#x2F;www.omnisecu.com&#x2F;cisco-certified-network-associate-">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2016-10-21T16:52:33.000Z">
<meta property="article:modified_time" content="2019-03-25T10:27:10.000Z">
<meta property="article:author" content="rennsong">
<meta property="article:tag" content="STP">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://rennesong.com/2016/10/22/TP-Ethernet-md/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Ethernet 交换实验准备工作 | Rennesong's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Rennesong's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Blog my life from now on!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://rennesong.com/2016/10/22/TP-Ethernet-md/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rennsong">
      <meta itemprop="description" content="Personal blog site, to note technique and life related articles">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Rennesong's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Ethernet 交换实验准备工作
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-10-22 00:52:33" itemprop="dateCreated datePublished" datetime="2016-10-22T00:52:33+08:00">2016-10-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-03-25 18:27:10" itemprop="dateModified" datetime="2019-03-25T18:27:10+08:00">2019-03-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="生成树算法">生成树算法</h1>
<p>介绍下，计算机科学中的经典算法。理论部分</p>
<h1 id="交换机中生成树算法工作原理">交换机中生成树算法工作原理</h1>
<p>概括来讲，STP的工作流程可以分为三个阶段： * Root Brideg 选举 * Root Port (for non-root bridge) 选举 * Designated Port 选举 - 【http://www.omnisecu.com/cisco-certified-network-associate-ccna/how-spanning-tree-protocol-stp-select-designated-port.php】 - 这个帖子对Designated Port的选举给出了非常详细的解释</p>
<p>以下帖子对STP原理部分 给出了非常 【https://www.pluralsight.com/blog/software-development/spanning-tree-protocol-tutorial】</p>
<p>以后最好 保留一些 STP 的traces，用以展示STP协议发送的packet的内容，比如有没有IP层？ 无图无真相。 For the election of the Root Bridge (bridge is equivalent to Switch), the one that will be the initial point of reference, switches manipulate and analyze the Root Bridge ID and Sender Bridge ID fields. Both of these fields consist of a six byte MAC address header and a two byte Bridge Priority header. The switch with the smallest Bridge Priority is automatically elected as the Root Bridge. If Bridge Priority is the same on all switches then the switch with the smaller MAC address is elected as the Root Bridge.</p>
<p>在 交换机 默认配置下，据说只有ARP diffusion 通过，那么发出请求的机器是如何知道 对应IP地址的MAC地址的呢？</p>
<p>对这句话也不是很理解，</p>
<p>il est en full duplex, donc le protocole CSMA/CD est désactivé. 我想那是因为 full duplex 是因为 发送还有接受方，走的是不同的channel(比如不同的频率)，所以根本不需要运行 CSMA/CD 协议 il est en half duplex, donc le protocole CSMA/CD est activé. 因为采用的是半双工，所以 发送以及接受，占用的都是同样的channel. 那么当然需要一些 冲突避免机制。</p>
<p>在命令行模式下 show interfaces status 注意比较这俩命令的区别： show interfaces status show interfaces show interface 端口名字 一个是以列表形式把所有interfaces的信息汇集起来显示出来，一个是把每个interface的信息详细地显示出来， 而show interface 端口名字 则是只详细显示一个端口的信息</p>
<h1 id="tp-中遇到的问题">TP 中遇到的问题</h1>
<h2 id="路由器-and-mac">路由器 and MAC</h2>
<p>实际上，一个交换机并不一定只具有一个 MAC 地址。比如为了支持 Spanning Tree Protocol (STP)，交换机的每个接口就需要有一个专属的M AC 地址。我们以 Telecom Bretagne 实验室的配置情况为例：该实验采用的是 Cisco Catalyst 3560 交换机。该交换机配备有8个 FastEthernet端口以及1个 GigaEthernet 端口。我们可以通过如下命令查看下， 这9个端口的MAC地址： <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Switch#<span class="keyword">show</span> mac<span class="operator">-</span>address<span class="operator">-</span><span class="keyword">table</span></span><br><span class="line">          Mac Address <span class="keyword">Table</span></span><br><span class="line"><span class="comment">-------------------------------------------</span></span><br><span class="line"></span><br><span class="line">Vlan    Mac Address       Type        Ports</span><br><span class="line"><span class="comment">----    -----------       --------    -----</span></span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0100.0</span>ccc.cccc    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0100.0</span>ccc.cccd    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0000</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0001</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0002</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0003</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0004</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0005</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0006</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0007</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0008</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0009</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.000</span>a    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.000</span>b    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.000</span>c    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.000</span>d    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.000</span>e    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.000</span>f    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    <span class="number">0180.</span>c200<span class="number">.0010</span>    <span class="keyword">STATIC</span>      CPU</span><br><span class="line"> <span class="keyword">All</span>    ffff.ffff.ffff    <span class="keyword">STATIC</span>      CPU</span><br><span class="line">   <span class="number">1</span>    <span class="number">0008.e3</span>ff.fc28    <span class="keyword">DYNAMIC</span>     Gi0<span class="operator">/</span><span class="number">1</span></span><br><span class="line">   <span class="number">1</span>    <span class="number">000</span>a<span class="number">.5e3</span>f<span class="number">.61</span>b0    <span class="keyword">DYNAMIC</span>     Gi0<span class="operator">/</span><span class="number">1</span></span><br><span class="line">   <span class="number">1</span>    <span class="number">000</span>a.f716<span class="number">.45</span>f6    <span class="keyword">DYNAMIC</span>     Gi0<span class="operator">/</span><span class="number">1</span></span><br><span class="line">   <span class="number">1</span>    <span class="number">0021.1</span>cb9<span class="number">.8981</span>    <span class="keyword">DYNAMIC</span>     Gi0<span class="operator">/</span><span class="number">1</span></span><br><span class="line">   <span class="number">1</span>    <span class="number">0021.566</span>a<span class="number">.0001</span>    <span class="keyword">DYNAMIC</span>     Gi0<span class="operator">/</span><span class="number">1</span></span><br><span class="line">   <span class="number">1</span>    <span class="number">0800.27</span>c6<span class="number">.3745</span>    <span class="keyword">DYNAMIC</span>     Gi0<span class="operator">/</span><span class="number">1</span></span><br><span class="line">   <span class="number">1</span>    f029<span class="number">.2973</span>.fd17    <span class="keyword">DYNAMIC</span>     Gi0<span class="operator">/</span><span class="number">1</span></span><br><span class="line">Total Mac Addresses <span class="keyword">for</span> this criterion: <span class="number">27</span></span><br></pre></td></tr></table></figure></p>
<p>STP的第一步是选择 Root Bridge, 选择标准是选择 Priority 最小的那个，如果所有的交换机的 Priority 的值都一样，那么选择 MAC 地址最小的那个。这里面，参与比较的 MAC 地址是交换机本身的 MAC 地址，而不是某个端口的 MAC 地址 （这一点，我有待确认，应该是这样的）。 所以我们可以通过命令 show spanning-tree 来查看 STP 有关的数据（其中必然其本身的 MAC 地址以及 Root Bridge MAC 地址）： <figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Switch</span>#show spanning-tree</span><br><span class="line">VLAN0001</span><br><span class="line">  Spanning tree enabled protocol ieee</span><br><span class="line">  Root ID    Priority    <span class="number">32769</span></span><br><span class="line">             <span class="built_in">Address</span>     <span class="number">0021.1</span>cb6.<span class="number">9880</span></span><br><span class="line">             This bridge is the root</span><br><span class="line">             Hello <span class="built_in">Time</span>   <span class="number">2</span> <span class="built_in">sec</span>  <span class="built_in">Max</span> Age <span class="number">20</span> <span class="built_in">sec</span>  Forward Delay <span class="number">15</span> <span class="built_in">sec</span></span><br><span class="line"></span><br><span class="line">  Bridge ID  Priority    <span class="number">32769</span>  (priority <span class="number">32768</span> sys-id-ext <span class="number">1</span>)</span><br><span class="line">             <span class="built_in">Address</span>     <span class="number">0021.1</span>cb6.<span class="number">9880</span></span><br><span class="line">             Hello <span class="built_in">Time</span>   <span class="number">2</span> <span class="built_in">sec</span>  <span class="built_in">Max</span> Age <span class="number">20</span> <span class="built_in">sec</span>  Forward Delay <span class="number">15</span> <span class="built_in">sec</span></span><br><span class="line">             Aging <span class="built_in">Time</span> <span class="number">300</span></span><br><span class="line"></span><br><span class="line">Interface        Role Sts Cost      Prio.Nbr <span class="built_in">Type</span></span><br><span class="line">---------------- ---- --- --------- -------- --------------------------------</span><br><span class="line"><span class="symbol">Gi0</span>/<span class="number">1</span>            Desg FWD <span class="number">19</span>        <span class="number">128.1</span>    Shr</span><br><span class="line"><span class="symbol">Fa0</span>/<span class="number">1</span>            Desg FWD <span class="number">19</span>        <span class="number">128.2</span>    P2p</span><br><span class="line"><span class="symbol">Fa0</span>/<span class="number">2</span>            Desg FWD <span class="number">19</span>        <span class="number">128.3</span>    P2p</span><br><span class="line"><span class="symbol">Fa0</span>/<span class="number">4</span>            Desg FWD <span class="number">19</span>        <span class="number">128.5</span>    P2p</span><br></pre></td></tr></table></figure></p>
<p>通过 命令 show interface Fa0/1，其输出如下： <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Switch</span>#show interface Fa<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"><span class="attribute">FastEthernet0</span>/<span class="number">1</span> is up, line protocol is up (connected)</span><br><span class="line">  <span class="attribute">Hardware</span> is Fast Ethernet, address is <span class="number">0021</span>.<span class="number">1</span>cb<span class="number">6</span>.<span class="number">9882</span> (bia <span class="number">0021</span>.<span class="number">1</span>cb<span class="number">6</span>.<span class="number">9882</span>)</span><br><span class="line">  <span class="attribute">MTU</span> <span class="number">1500</span> bytes, BW <span class="number">100000</span> Kbit, DLY <span class="number">100</span> usec,</span><br><span class="line">     <span class="attribute">reliability</span> <span class="number">255</span>/<span class="number">255</span>, txload <span class="number">1</span>/<span class="number">255</span>, rxload <span class="number">1</span>/<span class="number">255</span></span><br><span class="line">  <span class="attribute">Encapsulation</span> ARPA, loopback not set</span><br><span class="line">  <span class="attribute">Keepalive</span> set (<span class="number">10</span> sec)</span><br><span class="line">  <span class="attribute">Full</span>-duplex, <span class="number">100</span>Mb/s, media type is <span class="number">10</span>/<span class="number">100</span>BaseTX</span><br><span class="line">  <span class="attribute">input</span> flow-control is <span class="literal">off</span>, output flow-control is unsupported</span><br><span class="line">  <span class="attribute">ARP</span> type: ARPA, ARP Timeout <span class="number">04</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">  <span class="attribute">Last</span> input never, output <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, output hang never</span><br><span class="line">  <span class="attribute">Last</span> clearing of <span class="string">&quot;show interface&quot;</span> counters never</span><br><span class="line">  <span class="attribute">Input</span> queue: <span class="number">0</span>/<span class="number">75</span>/<span class="number">0</span>/<span class="number">0</span> (size/max/drops/flushes); Total output drops: <span class="number">0</span></span><br><span class="line">  <span class="attribute">Queueing</span> strategy: fifo</span><br><span class="line">  <span class="attribute">Output</span> queue: <span class="number">0</span>/<span class="number">40</span> (size/max)</span><br><span class="line">  <span class="attribute">5</span> minute input rate <span class="number">0</span> bits/sec, <span class="number">0</span> packets/sec</span><br><span class="line">  <span class="attribute">5</span> minute output rate <span class="number">0</span> bits/sec, <span class="number">0</span> packets/sec</span><br><span class="line">     <span class="attribute">53</span> packets input, <span class="number">4450</span> bytes, <span class="number">0</span> no buffer</span><br><span class="line">     <span class="attribute">Received</span> <span class="number">29</span> broadcasts (<span class="number">0</span> multicasts)</span><br><span class="line">     <span class="attribute">0</span> runts, <span class="number">0</span> giants, <span class="number">0</span> throttles</span><br><span class="line">     <span class="attribute">0</span> input errors, <span class="number">0</span> CRC, <span class="number">0</span> frame, <span class="number">0</span> overrun, <span class="number">0</span> ignored</span><br><span class="line">     <span class="attribute">0</span> watchdog, <span class="number">4</span> multicast, <span class="number">0</span> pause input</span><br><span class="line">     <span class="attribute">0</span> input packets with dribble condition detected</span><br><span class="line">     <span class="attribute">2169</span> packets output, <span class="number">191447</span> bytes, <span class="number">0</span> underruns</span><br><span class="line">     <span class="attribute">0</span> output errors, <span class="number">0</span> collisions, <span class="number">1</span> interface resets</span><br><span class="line">     <span class="attribute">0</span> babbles, <span class="number">0</span> late collision, <span class="number">0</span> deferred</span><br><span class="line">     <span class="attribute">0</span> lost carrier, <span class="number">0</span> no carrier, <span class="number">0</span> PAUSE output</span><br><span class="line">     <span class="attribute">0</span> output buffer failures, <span class="number">0</span> output buffers swapped out</span><br></pre></td></tr></table></figure></p>
<p>我们不妨再看一看, show interface Ga0/1 <figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Switch</span>#show interface GigabitEthernet<span class="number">0</span>/<span class="number">1</span></span><br><span class="line"><span class="attribute">GigabitEthernet0</span>/<span class="number">1</span> is up, line protocol is up (connected)</span><br><span class="line">  <span class="attribute">Hardware</span> is Gigabit Ethernet, address is <span class="number">0021</span>.<span class="number">1</span>cb<span class="number">6</span>.<span class="number">9881</span> (bia <span class="number">0021</span>.<span class="number">1</span>cb<span class="number">6</span>.<span class="number">9881</span>)</span><br><span class="line">  <span class="attribute">MTU</span> <span class="number">1500</span> bytes, BW <span class="number">100000</span> Kbit, DLY <span class="number">100</span> usec,</span><br><span class="line">     <span class="attribute">reliability</span> <span class="number">255</span>/<span class="number">255</span>, txload <span class="number">1</span>/<span class="number">255</span>, rxload <span class="number">1</span>/<span class="number">255</span></span><br><span class="line">  <span class="attribute">Encapsulation</span> ARPA, loopback not set</span><br><span class="line">  <span class="attribute">Keepalive</span> not set</span><br><span class="line">  <span class="attribute">Half</span>-duplex, <span class="number">100</span>Mb/s, link type is auto, media type is <span class="number">10</span>/<span class="number">100</span>/<span class="number">1000</span>BaseTX</span><br><span class="line">  <span class="attribute">input</span> flow-control is <span class="literal">off</span>, output flow-control is unsupported</span><br><span class="line">  <span class="attribute">ARP</span> type: ARPA, ARP Timeout <span class="number">04</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">  <span class="attribute">Last</span> input <span class="number">00</span>:<span class="number">00</span>:<span class="number">20</span>, output <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span>, output hang never</span><br><span class="line">  <span class="attribute">Last</span> clearing of <span class="string">&quot;show interface&quot;</span> counters never</span><br><span class="line">  <span class="attribute">Input</span> queue: <span class="number">0</span>/<span class="number">75</span>/<span class="number">0</span>/<span class="number">0</span> (size/max/drops/flushes); Total output drops: <span class="number">0</span></span><br><span class="line">  <span class="attribute">Queueing</span> strategy: fifo</span><br><span class="line">  <span class="attribute">Output</span> queue: <span class="number">0</span>/<span class="number">40</span> (size/max)</span><br><span class="line">  <span class="attribute">5</span> minute input rate <span class="number">0</span> bits/sec, <span class="number">0</span> packets/sec</span><br><span class="line">  <span class="attribute">5</span> minute output rate <span class="number">0</span> bits/sec, <span class="number">0</span> packets/sec</span><br><span class="line">     <span class="attribute">1057</span> packets input, <span class="number">155540</span> bytes, <span class="number">0</span> no buffer</span><br><span class="line">     <span class="attribute">Received</span> <span class="number">508</span> broadcasts (<span class="number">0</span> multicasts)</span><br><span class="line">     <span class="attribute">0</span> runts, <span class="number">0</span> giants, <span class="number">0</span> throttles</span><br><span class="line">     <span class="attribute">0</span> input errors, <span class="number">0</span> CRC, <span class="number">0</span> frame, <span class="number">0</span> overrun, <span class="number">0</span> ignored</span><br><span class="line">     <span class="attribute">0</span> watchdog, <span class="number">481</span> multicast, <span class="number">0</span> pause input</span><br><span class="line">     <span class="attribute">0</span> input packets with dribble condition detected</span><br><span class="line">     <span class="attribute">1652</span> packets output, <span class="number">128172</span> bytes, <span class="number">0</span> underruns</span><br><span class="line">     <span class="attribute">0</span> output errors, <span class="number">0</span> collisions, <span class="number">1</span> interface resets</span><br><span class="line">     <span class="attribute">0</span> babbles, <span class="number">0</span> late collision, <span class="number">0</span> deferred</span><br><span class="line">     <span class="attribute">0</span> lost carrier, <span class="number">0</span> no carrier, <span class="number">0</span> PAUSE output</span><br><span class="line">     <span class="attribute">0</span> output buffer failures, <span class="number">0</span> output buffers swapped out</span><br></pre></td></tr></table></figure> 其实，命令 show version 返回的信息之中，也是包含有 switch 的 MAC 地址的，比如如下输出：</p>
<p>（需要补充。。。）</p>
<p>在配置模式下, 输入如下命令： <figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conf t<span class="built_in"></span></span><br><span class="line"><span class="built_in">monitor </span>session 1 source plan 1<span class="built_in"></span></span><br><span class="line"><span class="built_in">monitor </span>session 1 destination interface Fa0/3</span><br><span class="line">exit</span><br></pre></td></tr></table></figure> 在命令行模式下，继续输入：write</p>
<p>为了完成本次TP，还需要熟悉工具 Iperf 的用法</p>
<h2 id="stp-收敛问题">STP 收敛问题</h2>
<p>虽然采用 STP 可以有效避免 交换机环路问题，但是 STP 协议的收敛时间 通常为 40-50 秒。这 STP 收敛时间期间， 所有的交换机是无法进行数据转发的，对于大型网络来说，也许拓扑结构的改变是时有发生的（比如插拔网线），如果每次STP都需要40-50秒的时间来处理这种改变，那么带来的延时对用户来说是无法忍受的。所以，在什么网络中，什么情况下使用 STP 需要慎重考虑。</p>
<h2 id="关于如何删除更改-vlan">关于如何删除/更改 VLAN</h2>
<p>有些学生在 TP 开始的时候，忘记了初始化switch，尤其在制造 Loopback 观察 STP如何关闭port的时候。有可能会因为因为不同的端口位于不同的VLAN上导致看不到预想的情况。这种情况下，我们需要知道，如何在 switch 更改/删除 VLAN。 以下命令，可以更改VLAN <figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">interface range gigabitEThernet <span class="number">1</span><span class="regexp">/0/</span><span class="number">3</span>-<span class="number">6</span></span><br><span class="line">switchport access vlan <span class="number">1</span></span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure> 以下命令，可以删除VLAN <figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">no</span><span class="built_in"> vlan </span>192</span><br></pre></td></tr></table></figure></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/STP/" rel="tag"># STP</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2015/08/19/LTE-Basics/" rel="prev" title="LTE-Basics">
      <i class="fa fa-chevron-left"></i> LTE-Basics
    </a></div>
      <div class="post-nav-item">
    <a href="/2016/10/22/TP-IPv6/" rel="next" title="IPv6 实验课准备以及遇到的问题">
      IPv6 实验课准备以及遇到的问题 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E6%A0%91%E7%AE%97%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">生成树算法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA%E4%B8%AD%E7%94%9F%E6%88%90%E6%A0%91%E7%AE%97%E6%B3%95%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-number">2.</span> <span class="nav-text">交换机中生成树算法工作原理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#tp-%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">3.</span> <span class="nav-text">TP 中遇到的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8-and-mac"><span class="nav-number">3.1.</span> <span class="nav-text">路由器 and MAC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#stp-%E6%94%B6%E6%95%9B%E9%97%AE%E9%A2%98"><span class="nav-number">3.2.</span> <span class="nav-text">STP 收敛问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E6%9B%B4%E6%94%B9-vlan"><span class="nav-number">3.3.</span> <span class="nav-text">关于如何删除&#x2F;更改 VLAN</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">rennsong</p>
  <div class="site-description" itemprop="description">Personal blog site, to note technique and life related articles</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">77</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">rennsong</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->




  















  

  

</body>
</html>
